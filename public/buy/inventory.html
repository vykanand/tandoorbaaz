<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TandoorBaaz - Inventory Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --success-color: #198754;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --light-bg: #f8f9fa;
            --dark-bg: #212529;
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        body {
            background-color: var(--light-bg);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar-brand {
            font-weight: 700;
            color: var(--primary-color) !important;
        }

        .card {
            border: none;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            background-color: white;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            font-weight: 600;
            padding: 1rem 1.25rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: #0b5ed7;
            transform: translateY(-1px);
        }

        .table th {
            font-weight: 600;
            background-color: #f8f9fa;
            border-top: none;
        }

        .nav-pills .nav-link.active {
            background-color: var(--primary-color);
            font-weight: 500;
        }

        .nav-pills .nav-link {
            color: var(--secondary-color);
            font-weight: 500;
        }

        .stat-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            color: white;
            margin-bottom: 1.5rem;
        }

        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .stat-card .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ingredient-row {
            transition: var(--transition);
        }

        .ingredient-row:hover {
            background-color: rgba(13, 110, 253, 0.05);
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .stat-card {
                margin-bottom: 1rem;
            }
            
            .chart-container {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-shop me-2"></i>TandoorBaaz
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="orders.html">Orders</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="inventory.html">Inventory</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mb-5">
        <div class="row mb-4">
            <div class="col-12">
                <h2 class="mb-4"><i class="bi bi-box-seam me-2"></i>Inventory Management</h2>
                
                <!-- Stats Cards -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="stat-card" style="background: linear-gradient(135deg, #4e73df, #224abe);">
                            <i class="bi bi-box-seam"></i>
                            <div class="stat-value" id="totalItems">0</div>
                            <div class="stat-label">Total Items</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card" style="background: linear-gradient(135deg, #1cc88a, #13855c);">
                            <i class="bi bi-check-circle"></i>
                            <div class="stat-value" id="inStock">0</div>
                            <div class="stat-label">In Stock</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card" style="background: linear-gradient(135deg, #f6c23e, #dda20a);">
                            <i class="bi bi-exclamation-triangle"></i>
                            <div class="stat-value" id="lowStock">0</div>
                            <div class="stat-label">Low Stock</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card" style="background: linear-gradient(135deg, #e74a3b, #be2617);">
                            <i class="bi bi-x-circle"></i>
                            <div class="stat-value" id="outOfStock">0</div>
                            <div class="stat-label">Out of Stock</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Left Column -->
            <div class="col-lg-8">
                <!-- Inventory List -->
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span><i class="bi bi-list-ul me-2"></i>Current Inventory</span>
                        <div>
                            <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addIngredientModal">
                                <i class="bi bi-plus-lg me-1"></i> Add Ingredient
                            </button>
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Ingredient</th>
                                        <th>Category</th>
                                        <th>Stock</th>
                                        <th>Unit</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="inventoryTableBody">
                                    <!-- Inventory items will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Top Dishes Chart -->
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-graph-up me-2"></i>Top Selling Dishes
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="topDishesChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="col-lg-4">
                <!-- Quick Actions -->
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-lightning-charge me-2"></i>Quick Actions
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button class="btn btn-outline-primary text-start" data-bs-toggle="modal" data-bs-target="#addDishModal">
                                <i class="bi bi-plus-circle me-2"></i>Add New Dish
                            </button>
                            <button class="btn btn-outline-success text-start" data-bs-toggle="modal" data-bs-target="#updateInventoryModal">
                                <i class="bi bi-arrow-repeat me-2"></i>Update Inventory
                            </button>
                            <button class="btn btn-outline-info text-start" data-bs-toggle="modal" data-bs-target="#generateReportModal">
                                <i class="bi bi-file-earmark-text me-2"></i>Generate Report
                            </button>
                            <button class="btn btn-outline-warning text-start" id="lowStockAlertBtn">
                                <i class="bi bi-exclamation-triangle me-2"></i>View Low Stock Alerts
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Recipe Management -->
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-book me-2"></i>Recipe Management
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Select Dish</label>
                            <select class="form-select" id="dishSelect">
                                <option value="">-- Select a dish --</option>
                            </select>
                        </div>
                        <div id="recipeIngredients" class="mb-3">
                            <!-- Recipe ingredients will be loaded here -->
                        </div>
                        <button class="btn btn-primary w-100" id="updateRecipeBtn">
                            <i class="bi bi-save me-2"></i>Update Recipe
                        </button>
                    </div>
                </div>

                <!-- Inventory Alerts -->
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <i class="bi bi-exclamation-triangle me-2"></i>Low Stock Alerts
                    </div>
                    <div class="card-body p-0">
                        <ul class="list-group list-group-flush" id="alertsList">
                            <!-- Alerts will be loaded here -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Ingredient Modal -->
    <div class="modal fade" id="addIngredientModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Ingredient</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addIngredientForm">
                        <div class="mb-3">
                            <label class="form-label">Ingredient Name</label>
                            <input type="text" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Category</label>
                            <select class="form-select" required>
                                <option value="">Select Category</option>
                                <option value="vegetables">Vegetables</option>
                                <option value="meat">Meat</option>
                                <option value="dairy">Dairy</option>
                                <option value="spices">Spices</option>
                                <option value="grains">Grains</option>
                                <option value="oils">Oils & Fats</option>
                                <option value="others">Others</option>
                            </select>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Current Stock</label>
                                <input type="number" class="form-control" step="0.01" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Unit</label>
                                <select class="form-select" required>
                                    <option value="kg">Kilogram (kg)</option>
                                    <option value="g">Gram (g)</option>
                                    <option value="l">Liter (L)</option>
                                    <option value="ml">Milliliter (ml)</option>
                                    <option value="pcs">Pieces</option>
                                    <option value="packet">Packet</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Minimum Required</label>
                            <input type="number" class="form-control" step="0.01" required>
                            <div class="form-text">Alert when stock goes below this level</div>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">Add Ingredient</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Dish Modal -->
    <div class="modal fade" id="addDishModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Dish</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addDishForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Dish Name</label>
                                <input type="text" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Category</label>
                                <select class="form-select" required>
                                    <option value="">Select Category</option>
                                    <option value="starters">Starters</option>
                                    <option value="main-course">Main Course</option>
                                    <option value="breads">Breads</option>
                                    <option value="rice">Rice & Biryani</option>
                                    <option value="desserts">Desserts</option>
                                    <option value="beverages">Beverages</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" rows="2"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ingredients</label>
                            <div id="dishIngredients">
                                <!-- Ingredient rows will be added here -->
                            </div>
                            <button type="button" class="btn btn-sm btn-outline-secondary mt-2" id="addIngredientBtn">
                                <i class="bi bi-plus-lg"></i> Add Ingredient
                            </button>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Selling Price (₹)</label>
                                <input type="number" class="form-control" step="0.01" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Cost Price (₹)</label>
                                <input type="number" class="form-control" step="0.01" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Preparation Time (min)</label>
                                <input type="number" class="form-control" value="15" min="0">
                            </div>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">Save Dish</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Inventory Modal -->
    <div class="modal fade" id="updateInventoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Update Inventory</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="updateInventoryForm">
                        <div class="mb-3">
                            <label class="form-label">Select Ingredient</label>
                            <select class="form-select" id="ingredientSelect" required>
                                <option value="">-- Select Ingredient --</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Adjustment Type</label>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="radio" name="adjustmentType" id="addStock" value="add" checked>
                                <label class="form-check-label" for="addStock">
                                    Add to Stock
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="radio" name="adjustmentType" id="removeStock" value="remove">
                                <label class="form-check-label" for="removeStock">
                                    Remove from Stock
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Quantity</label>
                            <div class="input-group">
                                <input type="number" class="form-control" step="0.01" required>
                                <span class="input-group-text" id="unitDisplay">kg</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Notes (Optional)</label>
                            <textarea class="form-control" rows="2"></textarea>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">Update Inventory</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample data - In a real app, this would come from a database
        let inventory = [];
        let dishes = [];
        let categories = [
            { id: 'starters', name: 'Starters' },
            { id: 'main-course', name: 'Main Course' },
            { id: 'breads', name: 'Breads' },
            { id: 'rice', name: 'Rice & Biryani' },
            { id: 'desserts', name: 'Desserts' },
            { id: 'beverages', name: 'Beverages' }
        ];

        // DOM Elements
        const inventoryTableBody = document.getElementById('inventoryTableBody');
        const dishSelect = document.getElementById('dishSelect');
        const recipeIngredients = document.getElementById('recipeIngredients');
        const alertsList = document.getElementById('alertsList');
        const totalItemsEl = document.getElementById('totalItems');
        const inStockEl = document.getElementById('inStock');
        const lowStockEl = document.getElementById('lowStock');
        const outOfStockEl = document.getElementById('outOfStock');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            loadSampleData();
            renderInventory();
            renderDishSelect();
            updateStats();
            initCharts();
            setupEventListeners();
        });

        // Load sample data (replace with API calls in production)
        function loadSampleData() {
            // Sample inventory data
            inventory = [
                { id: 1, name: 'Chicken', category: 'meat', stock: 25.5, unit: 'kg', minRequired: 10, status: 'in-stock' },
                { id: 2, name: 'Rice Basmati', category: 'grains', stock: 48.2, unit: 'kg', minRequired: 20, status: 'in-stock' },
                { id: 3, name: 'Tomatoes', category: 'vegetables', stock: 15.3, unit: 'kg', minRequired: 5, status: 'in-stock' },
                { id: 4, name: 'Onions', category: 'vegetables', stock: 8.7, unit: 'kg', minRequired: 10, status: 'low-stock' },
                { id: 5, name: 'Ginger Garlic Paste', category: 'spices', stock: 2.1, unit: 'kg', minRequired: 2, status: 'low-stock' },
                { id: 6, name: 'Yogurt', category: 'dairy', stock: 12.5, unit: 'kg', minRequired: 5, status: 'in-stock' },
                { id: 7, name: 'Butter', category: 'dairy', stock: 0, unit: 'kg', minRequired: 2, status: 'out-of-stock' },
                { id: 8, name: 'Coriander Powder', category: 'spices', stock: 1.5, unit: 'kg', minRequired: 1, status: 'in-stock' },
                { id: 9, name: 'Green Chilies', category: 'vegetables', stock: 0.5, unit: 'kg', minRequired: 1, status: 'low-stock' },
                { id: 10, name: 'Coriander Leaves', category: 'vegetables', stock: 0.8, unit: 'kg', minRequired: 1, status: 'low-stock' }
            ];

            // Sample dishes data (would come from orders system)
            dishes = [
                {
                    id: 1,
                    name: 'Butter Chicken',
                    category: 'main-course',
                    price: 350,
                    cost: 120,
                    ingredients: [
                        { id: 1, name: 'Chicken', quantity: 0.3, unit: 'kg' },
                        { id: 2, name: 'Rice Basmati', quantity: 0.2, unit: 'kg' },
                        { id: 3, name: 'Tomatoes', quantity: 0.4, unit: 'kg' },
                        { id: 4, name: 'Onions', quantity: 0.2, unit: 'kg' },
                        { id: 5, name: 'Ginger Garlic Paste', quantity: 0.05, unit: 'kg' },
                        { id: 6, name: 'Yogurt', quantity: 0.1, unit: 'kg' },
                        { id: 7, name: 'Butter', quantity: 0.05, unit: 'kg' },
                        { id: 8, name: 'Coriander Powder', quantity: 0.01, unit: 'kg' },
                        { id: 9, name: 'Green Chilies', quantity: 0.02, unit: 'kg' },
                        { id: 10, name: 'Coriander Leaves', quantity: 0.01, unit: 'kg' }
                    ],
                    salesCount: 245,
                    profitMargin: 0.66
                },
                // Add more sample dishes as needed
            ];
        }

        // Render inventory table
        function renderInventory() {
            inventoryTableBody.innerHTML = '';
            
            inventory.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'ingredient-row';
                
                // Determine status badge
                let statusBadge = '';
                if (item.status === 'in-stock') {
                    statusBadge = '<span class="badge bg-success">In Stock</span>';
                } else if (item.status === 'low-stock') {
                    statusBadge = '<span class="badge bg-warning">Low Stock</span>';
                } else {
                    statusBadge = '<span class="badge bg-danger">Out of Stock</span>';
                }
                
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${formatCategory(item.category)}</td>
                    <td>${item.stock} ${item.unit}</td>
                    <td>${formatUnit(item.unit)}</td>
                    <td>${statusBadge}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="editIngredient(${item.id})">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteIngredient(${item.id})">
                            <i class="bi bi-trash"></i>
                        </button>
                    </td>
                `;
                
                inventoryTableBody.appendChild(row);
            });
            
            updateAlerts();
        }

        // Render dish select dropdown
        function renderDishSelect() {
            dishSelect.innerHTML = '<option value="">-- Select a dish --</option>';
            
            dishes.forEach(dish => {
                const option = document.createElement('option');
                option.value = dish.id;
                option.textContent = dish.name;
                dishSelect.appendChild(option);
            });
        }

        // Update statistics
        function updateStats() {
            const total = inventory.length;
            const inStock = inventory.filter(item => item.status === 'in-stock').length;
            const lowStock = inventory.filter(item => item.status === 'low-stock').length;
            const outOfStock = inventory.filter(item => item.status === 'out-of-stock').length;
            
            totalItemsEl.textContent = total;
            inStockEl.textContent = inStock;
            lowStockEl.textContent = lowStock;
            outOfStockEl.textContent = outOfStock;
        }

        // Update alerts
        function updateAlerts() {
            alertsList.innerHTML = '';
            
            const lowStockItems = inventory.filter(item => item.status === 'low-stock' || item.status === 'out-of-stock');
            
            if (lowStockItems.length === 0) {
                const li = document.createElement('li');
                li.className = 'list-group-item text-center text-muted';
                li.textContent = 'No alerts at the moment';
                alertsList.appendChild(li);
                return;
            }
            
            lowStockItems.forEach(item => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                
                const statusClass = item.status === 'out-of-stock' ? 'danger' : 'warning';
                const statusText = item.status === 'out-of-stock' ? 'Out of Stock' : 'Low Stock';
                
                li.innerHTML = `
                    <div>
                        <strong>${item.name}</strong><br>
                        <small class="text-muted">${item.stock} ${item.unit} remaining</small>
                    </div>
                    <span class="badge bg-${statusClass}">${statusText}</span>
                `;
                
                alertsList.appendChild(li);
            });
        }

        // Initialize charts
        function initCharts() {
            // Top Dishes Chart
            const topDishesCtx = document.getElementById('topDishesChart').getContext('2d');
            const topDishesData = {
                labels: ['Butter Chicken', 'Chicken Tikka', 'Paneer Tikka', 'Dal Makhani', 'Naan'],
                datasets: [{
                    label: 'Sales (Last 30 Days)',
                    data: [245, 198, 156, 134, 112],
                    backgroundColor: [
                        'rgba(54, 162, 235, 0.6)',
                        'rgba(255, 99, 132, 0.6)',
                        'rgba(255, 206, 86, 0.6)',
                        'rgba(75, 192, 192, 0.6)',
                        'rgba(153, 102, 255, 0.6)'
                    ],
                    borderColor: [
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 99, 132, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)'
                    ],
                    borderWidth: 1
                }]
            };
            
            new Chart(topDishesCtx, {
                type: 'bar',
                data: topDishesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Orders'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Dishes'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.parsed.y} orders`;
                                }
                            }
                        }
                    }
                }
            });

            // You can add more charts here for other analytics
        }

        // Setup event listeners
        function setupEventListeners() {
            // Dish select change
            dishSelect.addEventListener('change', (e) => {
                const dishId = parseInt(e.target.value);
                if (dishId) {
                    const dish = dishes.find(d => d.id === dishId);
                    if (dish) {
                        renderRecipeIngredients(dish);
                    }
                } else {
                    recipeIngredients.innerHTML = '<p class="text-muted text-center py-3">Select a dish to view and edit its recipe</p>';
                }
            });

            // Add ingredient button
            document.getElementById('addIngredientBtn')?.addEventListener('click', () => {
                const dishIngredients = document.getElementById('dishIngredients');
                const row = document.createElement('div');
                row.className = 'row g-2 mb-2';
                row.innerHTML = `
                    <div class="col-5">
                        <select class="form-select form-select-sm">
                            <option value="">Select Ingredient</option>
                            ${inventory.map(item => `<option value="${item.id}">${item.name}</option>`).join('')}
                        </select>
                    </div>
                    <div class="col-3">
                        <input type="number" class="form-control form-control-sm" placeholder="Qty" step="0.01">
                    </div>
                    <div class="col-3">
                        <select class="form-select form-select-sm">
                            <option value="g">g</option>
                            <option value="kg">kg</option>
                            <option value="ml">ml</option>
                            <option value="l">L</option>
                            <option value="pcs">pcs</option>
                        </select>
                    </div>
                    <div class="col-1">
                        <button type="button" class="btn btn-sm btn-outline-danger w-100" onclick="this.closest('.row').remove()">
                            <i class="bi bi-x"></i>
                        </button>
                    </div>
                `;
                dishIngredients.appendChild(row);
            });

            // Form submissions
            document.getElementById('addIngredientForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                // In a real app, this would save to a database
                alert('Ingredient added successfully!');
                $('#addIngredientModal').modal('hide');
                // Reset form
                e.target.reset();
            });

            document.getElementById('addDishForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                // In a real app, this would save to a database
                alert('Dish added successfully!');
                $('#addDishModal').modal('hide');
                // Reset form
                e.target.reset();
            });

            document.getElementById('updateInventoryForm')?.addEventListener('submit', (e) => {
                e.preventDefault();
                // In a real app, this would update the database
                alert('Inventory updated successfully!');
                $('#updateInventoryModal').modal('hide');
                // Reset form
                e.target.reset();
            });
        }

        // Helper functions
        function formatCategory(category) {
            return category.split('-').map(word => 
                word.charAt(0).toUpperCase() + word.slice(1)
            ).join(' ');
        }

        function formatUnit(unit) {
            const units = {
                'kg': 'Kilogram',
                'g': 'Gram',
                'l': 'Liter',
                'ml': 'Milliliter',
                'pcs': 'Pieces',
                'packet': 'Packet'
            };
            return units[unit] || unit;
        }

        function renderRecipeIngredients(dish) {
            recipeIngredients.innerHTML = `
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Ingredient</th>
                                <th>Quantity</th>
                                <th>Unit</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${dish.ingredients.map(ing => {
                                const item = inventory.find(i => i.id === ing.id);
                                let status = '';
                                
                                if (!item) {
                                    status = '<span class="badge bg-secondary">Not in Inventory</span>';
                                } else if (item.status === 'out-of-stock') {
                                    status = '<span class="badge bg-danger">Out of Stock</span>';
                                } else if (item.status === 'low-stock') {
                                    status = '<span class="badge bg-warning">Low Stock</span>';
                                } else {
                                    status = '<span class="badge bg-success">In Stock</span>';
                                }
                                
                                return `
                                    <tr>
                                        <td>${ing.name}</td>
                                        <td>${ing.quantity}</td>
                                        <td>${ing.unit}</td>
                                        <td>${status}</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
                <div class="mt-2">
                    <strong>Cost Price:</strong> ₹${dish.cost.toFixed(2)}<br>
                    <strong>Selling Price:</strong> ₹${dish.price.toFixed(2)}<br>
                    <strong>Profit Margin:</strong> ${(dish.profitMargin * 100).toFixed(1)}%
                </div>
            `;
        }

        // These would be connected to actual functionality in a real app
        window.editIngredient = function(id) {
            alert(`Edit ingredient with ID: ${id}`);
        };

        window.deleteIngredient = function(id) {
            if (confirm('Are you sure you want to delete this ingredient?')) {
                // In a real app, this would delete from the database
                inventory = inventory.filter(item => item.id !== id);
                renderInventory();
                updateStats();
            }
        };

        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
    </script>
</body>
</html>
